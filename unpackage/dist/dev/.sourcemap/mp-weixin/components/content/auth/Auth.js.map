{"version":3,"sources":["webpack:///C:/Users/Administrator/Desktop/uiapp/new/components/content/auth/Auth.vue?57a3","webpack:///C:/Users/Administrator/Desktop/uiapp/new/components/content/auth/Auth.vue?0d98","webpack:///C:/Users/Administrator/Desktop/uiapp/new/components/content/auth/Auth.vue?3686","webpack:///C:/Users/Administrator/Desktop/uiapp/new/components/content/auth/Auth.vue?a931","webpack:///C:/Users/Administrator/Desktop/uiapp/new/components/content/auth/Auth.vue"],"names":["name","data","components","AuthModal","UniPopup","mounted","uni","getStorageSync","then","res","getKeyParam","code","appid","$store","state","kRes","setStorageSync","session_key","openid","$refs","popup","open","methods","authForInfo","e","detail","errMsg","openId","userInfo","JSON","stringify","closePop","popupPhone","sendUserInfo","phone","parse","Object","assign","seller_id","sid","console","log","closePopPhone","close","isGetPhone","toReqGetPhone"],"mappings":"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","file":"components/content/auth/Auth.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./Auth.vue?vue&type=template&id=36859252&scoped=true&\"\nvar renderjs\nimport script from \"./Auth.vue?vue&type=script&lang=js&\"\nexport * from \"./Auth.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"36859252\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"Desktop/uiapp/new/components/content/auth/Auth.vue\"\nexport default component.exports","export * from \"-!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./Auth.vue?vue&type=template&id=36859252&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./Auth.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../Downloads/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./Auth.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\timport AuthModal from '@/components/common/authModal/auth-modal.vue'\n\timport UniPopup from '@/components/common/uni-popup/uni-popup.vue'\n\timport {\n\t\tgetCodeForOauth,\n\t\tgetPhoneNumber\n\t} from '@/common/authFun.js'\n\timport {getKey,saveUserInfo} from '@/network/auth.js'\n\t\n    export default {\n        name: \"auth\",\n        data(){\n\t\t\treturn{\n\t\t\t\t\n\t\t\t}\n        },\n        components:{\n\t\t\tAuthModal,\n            UniPopup,\n        },\n\t\tmounted() {\n\t\t\t// // 先获取code，发送code至后台获取openid和session_key\n\t\t\tif (!uni.getStorageSync('userInfo')) {\n\t\t\t\tgetCodeForOauth('oauth').then(res => {\n\t\t\t\t\t// console.log('res:', res); // {code:\"...\"errMsg:\"login:ok\"}\n\t\t\t\t\t// uni.setStorageSync('code', res.code)\n\t\t\t\t\tconst getKeyParam = {\n\t\t\t\t\t\tcode:res.code, \n\t\t\t\t\t\tappid:this.$store.state.appid,\n\t\t\t\t\t}\n\t\t\t\t\tgetKey(getKeyParam).then(kRes => {\n\t\t\t\t\t\tuni.setStorageSync('session_key', kRes.data.session_key)\n\t\t\t\t\t\tuni.setStorageSync('openid', kRes.data.openid)\n\t\t\t\t\t\tthis.$refs.popup.open()\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\n\t\t\t}\n\t\t\t\n\t\t},\n\t\tmethods: {\n\t\t\t// 授权获取信息\n\t\t\tauthForInfo(e) {\n\t\t\t\tif(e.detail.errMsg !=='getUserInfo:fail auth deny'){\n\t\t\t\t\tlet openId = uni.getStorageSync('openid')\n\t\t\t\t\tlet userInfo = e.detail.userInfo\n\t\t\t\t\tuserInfo['nickname'] = userInfo['nickName']\n\t\t\t\t\tuserInfo['headimgurl'] = userInfo['avatarUrl']\n\t\t\t\t\tuni.setStorageSync('userInfo', JSON.stringify(userInfo))\n\t\t\t\t\tthis.closePop()\n\t\t\t\t\tthis.$refs.popupPhone.open()\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t},\n\t\t\t// 提交用户信息\n\t\t\tsendUserInfo(phone){\n\t\t\t\tlet userInfo = JSON.parse(uni.getStorageSync('userInfo')) \n\t\t\t\tObject.assign(userInfo, {\n\t\t\t\t\topenid: uni.getStorageSync('openid'),\n\t\t\t\t\tseller_id : this.$store.state.sid,\n\t\t\t\t\tphone:  phone\n\t\t\t\t})\n\t\t\t\tsaveUserInfo(userInfo).then((res) => {\n\t\t\t\t\tconsole.log('手机号提交成功')\n\t\t\t\t\tthis.closePopPhone(true)\n\t\t\t\t\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t//关闭弹框\n\t\t\tclosePop() {\n\t\t\t\tthis.$refs.popup.close()\n\t\t\t},\n\t\t\t//关闭获取手机弹框\n\t\t\tclosePopPhone(isGetPhone) {\n\t\t\t\tif(!isGetPhone){\n\t\t\t\t\tthis.sendUserInfo('')\n\t\t\t\t}\n\t\t\t\tthis.$refs.popupPhone.close();\n\t\t\t\t\n\t\t\t},\n\t\t\t\n\t\t\t// 获取手机号\n\t\t\ttoReqGetPhone(e) {\n\t\t\t\t //检查session_key是否过期,过期则从新获取session_key\n\t\t\t\tgetPhoneNumber(e.detail).then(res => {\n\t\t\t\t\t// uni.setStorageSync('phone', res.data)\n\t\t\t\t\tthis.sendUserInfo(res.data)\n\t\t\t\t})\n\t\t\t\t\n\t\t\t},\n\t\t}\n    }\n"],"sourceRoot":""}